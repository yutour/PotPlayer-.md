---
title: "WSL ç›¸å…³é…ç½®"
---

> WSL Ubuntu 20.04 ç›¸å…³é…ç½®ï¼Œå‚è€ƒè‡ª [WSL2][link006]ã€[é…ç½®][link001]ã€
> [ä¿®æ”¹ hostname][link007]

# ğŸš€ è½¬æ¢ WSL1 ä¸º WSL2ï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…å°±å…ˆæ‰§è¡Œ 1 2 3 æ­¥ååœ¨åœ¨å•†åº—é‡Œå®‰è£…å‘è¡Œç‰ˆï¼‰

1. æ§åˆ¶é¢æ¿->å¯ç”¨æˆ–å…³é—­ Windows åŠŸèƒ½ä¸­é€‰ä¸­ `è™šæ‹Ÿæœºå¹³å°` ç»„ä»¶ï¼Œæç¤ºéœ€è¦é‡å¯
2. ä¸‹è½½ Linux å†…æ ¸æ›´æ–°åŒ…å¹¶å®‰è£…ï¼š[x64 WSL2 Linux å†…æ ¸][link005]
3. è®¾ç½® WSL2 ä¸ºé»˜è®¤ç‰ˆæœ¬ï¼š`wsl --set-default-version 2`
4. æŸ¥çœ‹ WSL ç‰ˆæœ¬ 2

   ```powershell
   wsl -l -v
   ```

5. å¦‚æœä¸Šé¢å‘½ä»¤æ˜¾ç¤º WSL ç‰ˆæœ¬ä¸º 1ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤è®¾ä¸º 2

   ```powershell
   wsl --set-version Ubuntu-20.04 2
   ```

æç¤ºéœ€è¦ç­‰ä¸€ä¼šï¼Œç„¶åæ‰§è¡Œæ­¥éª¤ 4 æŸ¥çœ‹ WSL ç‰ˆæœ¬å·²ç»ä¸º 2 äº†ã€‚

# ğŸš€ ä¿®æ”¹ root å¯†ç 

```bash
sudo passwd root
```

ä½¿ç”¨ `su` å‘½ä»¤æµ‹è¯•ä¿®æ”¹æ˜¯å¦æˆåŠŸã€‚

# ğŸš€ æ›´æ¢è½¯ä»¶æºå¹¶æ›´æ–°ç³»ç»Ÿ

> å‚è€ƒé˜¿é‡Œæºå’Œæ¸…åæºçš„ Ubuntu æºé…ç½®å¸®åŠ©ï¼š[é˜¿é‡Œæº][link002]ã€[æ¸…åæº][link003]

1. å¤‡ä»½é»˜è®¤æº

   ```bash
   # åˆ‡æ¢åˆ° root ç”¨æˆ·
   su
   # å¤‡ä»½é»˜è®¤æº
   cp /etc/apt/sources.list /etc/apt/sources.list.bak
   ```

2. è®¾ç½®å›½å†…æºï¼ˆæ¨èä½¿ç”¨é˜¿é‡Œæºï¼Œæ¸…åæºåœ¨æ›´æ–°æ—¶å€™ä¼šæŠ¥é”™ï¼‰

   - è®¾ç½®æ¸…åæºå¹¶æ³¨é‡Šé»˜è®¤æºï¼Œæ¸…ç©ºå¹¶å†™å…¥ä¸‹é¢å†…å®¹åˆ° `/etc/apt/sources.list`

     ```text
     deb http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse
     deb-src http://mirrors.aliyun.com/ubuntu/ focal main restricted universe multiverse

     deb http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse
     deb-src http://mirrors.aliyun.com/ubuntu/ focal-security main restricted universe multiverse

     deb http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse
     deb-src http://mirrors.aliyun.com/ubuntu/ focal-updates main restricted universe multiverse

     deb http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse
     deb-src http://mirrors.aliyun.com/ubuntu/ focal-proposed main restricted universe multiverse

     deb http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse
     deb-src http://mirrors.aliyun.com/ubuntu/ focal-backports main restricted universe multiverse

     ```

   - è®¾ç½®æ¸…åæºå¹¶æ³¨é‡Šé»˜è®¤æºï¼Œæ¸…ç©ºå¹¶å†™å…¥ä¸‹é¢å†…å®¹åˆ° `/etc/apt/sources.list`

     ```text
     # é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š
     deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse
     # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse
     deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
     # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse
     deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse
     # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse
     deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse
     # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse

     # é¢„å‘å¸ƒè½¯ä»¶æºï¼Œä¸å»ºè®®å¯ç”¨
     # deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse
     # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-proposed main restricted universe multiverse
     ```

3. æ›´æ–°è½¯ä»¶æºå¹¶æ›´æ–°ç³»ç»Ÿ

   ```bash
   # æ›´æ¢è½¯ä»¶æº
   sudo apt update
   # æ›´æ–°ç³»ç»Ÿ
   sudo apt upgrade
   ```

   - å¦‚æœæ— é”™ï¼Œåˆ™è½¯ä»¶æºé…ç½®å®Œæˆä¸”ç³»ç»Ÿå·²ä¸ºæœ€æ–°ï¼Œå¦‚æœå‡ºé”™ï¼Œåšå¦‚ä¸‹æ“ä½œï¼šï¼ˆ[å‚è€ƒè¿™é‡Œ][link004]ï¼‰

     1. åˆ é™¤ /etc/resolv.conf æ–‡ä»¶ï¼Œå¿…é¡»åˆ é™¤ï¼Œè¿™æ˜¯ä¸€ä¸ªé“¾æ¥æ–‡ä»¶ï¼š`rm /etc/resolv.conf`
     2. æŠŠä¸‹é¢å†…å®¹å†™å…¥è¿™ä¸ªæ–‡ä»¶ï¼Œä¸€å®šè¦ç¡®ä¿çœŸæ­£å†™è¿›å»äº†ï¼ï¼š`sudo vim /etc/resolv.conf`

        ```text
        # Add the lines
        nameserver 8.8.8.8
        nameserver 8.8.4.4
        ```

     3. æŠŠä¸‹é¢å†…å®¹å†™å…¥ `/etc/wsl.conf` æ–‡ä»¶

        ```text
        root = /
        options = "metadata"
        [network]
        generateResolvConf = false
        ```

     4. æ­¤æ—¶å†ä¾æ¬¡æ‰§è¡Œ `sudo apt update` å’Œ `sudo apt upgrade`

# ğŸš€ è®¾ç½® hostnameï¼Œä¸”ä¸ä¿®æ”¹ windows ä¸»æœºåï¼ˆéœ€è¦é‡å¯ï¼‰

åœ¨ `/etc/wsl.conf` é‡Œé¢çš„ `[network]` ä¸‹é¢åŠ ä¸€è¡Œ `"hostname=WSL"`ï¼Œ
ä¸åŒ…æ‹¬å¼•å·ï¼Œå³å¯è®¾ç½® WSL çš„ä¸»æœºåï¼Œ
åŒæ—¶ä¸ç”¨ä¿®æ”¹ Windows ä¸»æœºåå­—ã€‚å¦‚æœæ²¡æœ‰ `/etc/wsl.conf` æ–‡ä»¶å°±æ–°å»ºä¸€ä¸ªã€‚

é…ç½®ç¤ºä¾‹ï¼š

```text
[user]
default=yangdi

[network]
generateResolvConf=false
hostname=WSL
```

# ğŸš€ è®¾ç½®å¼€æœºè‡ªå¯ï¼Œåå°è¿è¡Œ

# ğŸš€ è®¾ç½® WSL2 å›ºå®š ipï¼Œæ–­ç½‘ä¹Ÿèƒ½äº’è”

[link001]: https://www.freesion.com/article/73601305348/
[link002]: https://developer.aliyun.com/mirror/ubuntu?spm=a2c6h.13651102.0.0.3e221b113qLEmm
[link003]: https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/
[link004]: https://www.cnblogs.com/matt1985/p/13435912.html
[link005]: https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi
[link006]: https://docs.microsoft.com/zh-cn/windows/wsl/install-manual#step-4---download-the-linux-kernel-update-package
[link007]: https://www.cnblogs.com/stellae/p/14969599.html
